using CapaDatos;
using CapaEntidades;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CapaNegocio
{
    public class DetalleVentaBLL
    {
        private DetalleVentaDAL detalleDAL = new DetalleVentaDAL();

        // INSERTAR
        public int Insertar(DetalleVenta detalle)
        {
            if (detalle.id_venta <= 0)
                throw new Exception("Venta inválida.");

            if (detalle.id_producto <= 0)
                throw new Exception("Producto inválido.");

            if (detalle.cantidad <= 0)
                throw new Exception("La cantidad debe ser mayor a cero.");

            if (detalle.precio <= 0)
                throw new Exception("El precio debe ser mayor a cero.");

            return detalleDAL.Insertar(detalle);
        }

        // LISTAR
        public List<DetalleVenta> Listar()
        {
            return detalleDAL.Listar();
        }

        // ACTUALIZAR
        public void Actualizar(DetalleVenta detalle)
        {
            if (detalle.id_detalle <= 0)
                throw new Exception("ID de detalle inválido.");

            detalleDAL.Actualizar(detalle);
        }

        // ELIMINAR
        public void Eliminar(int id_detalle)
        {
            if (id_detalle <= 0)
                throw new Exception("ID de detalle inválido.");

            detalleDAL.Eliminar(id_detalle);
        }
    }
}