using CapaDatos;
using CapaEntidades;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

namespace CapaNegocio
{
    public class ClienteBLL
    {
        private ClienteDAL clienteDAL = new ClienteDAL();

        // INSERTAR
        public void Insertar(Cliente cliente)
        {
            if (string.IsNullOrWhiteSpace(cliente.nombre))
                throw new Exception("El nombre es obligatorio.");

            if (!string.IsNullOrWhiteSpace(cliente.correo))
            {
                if (!Regex.IsMatch(cliente.correo, @"^[^@\s]+@[^@\s]+\.[^@\s]+$"))
                    throw new Exception("Correo inválido.");
            }

            clienteDAL.Insertar(cliente);
        }

        // LISTAR
        public List<Cliente> Listar()
        {
            return clienteDAL.Listar();
        }

        // ACTUALIZAR
        public void Actualizar(Cliente cliente)
        {
            if (cliente.id_cliente <= 0)
                throw new Exception("ID inválido.");

            if (string.IsNullOrWhiteSpace(cliente.nombre))
                throw new Exception("El nombre es obligatorio.");

            clienteDAL.Actualizar(cliente);
        }

        // ELIMINAR
        public void Eliminar(int id)
        {
            if (id <= 0)
                throw new Exception("ID inválido.");

            clienteDAL.Eliminar(id);
        }
    }

// Compatibility wrapper: many forms expect a type named "ClienteBL" (single L).
// Provide a thin subclass so existing code compiles without changing all forms.
namespace CapaNegocio
{
    public class ClienteBL : ClienteBLL
    {
    }
}
}